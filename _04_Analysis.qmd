# Methods

## Clustering
To identify regions of the ocean with similar environmental profiles, we performed unsupervised clustering using the K-means algorithm. This method grouped ocean observation points based on a combination of spatial and environmental variables: latitude, longitude, nitrate concentration, plankton abundance, chlorophyll levels, shipping density, and distance from the nearest coastline.
Prior to clustering, chlorophyll values were averaged at a 0.01° grid resolution and merged with the nitrate and plankton data from the World Ocean Database. Shipping density values were extracted at each point location from a raster image provided by the World Bank Group. A shapefile of global coastlines was used to compute the Euclidean distance of each observation from land using a spatial index (STRtree). All datasets were merged into a single data frame and any missing values were filled with zeroes before clustering.
To ensure comparability between variables with different scales and units, we applied z-score standardization to each feature. We used the elbow method to determine the optimal number of clusters, plotting the within-cluster sum of squares (inertia) across values of k from 2 to 15. The kneed package was used to automatically detect the inflection point of this curve. Based on the elbow method, we selected k=4 as the optimal number of clusters.
We then trained a K-means model with four clusters and assigned each ocean observation to one of the clusters. The resulting clusters were visualized globally and separately using Cartopy, which revealed geographic groupings that reflect underlying environmental similarities. These cluster assignments were used in subsequent statistical analysis (e.g., chi-square tests, ANOVA) to examine how nitrate and phytoplankton levels vary across shipping intensities within similar ecological zones.

## Chi Square
Before applying regression models, we first wanted to establish whether there was a statistically significant association between shipping density and nitrate levels. To do this, we performed a chi-square test of independence using data limited to the Atlantic Ocean, where sampling density was highest and regional patterns were most coherent.
We began by categorizing each observation point into “Low,” “Average,” or “High” shipping density based on standard deviation cutoffs from the mean. A similar categorization was applied to nitrate concentrations using the same logic. This resulted in a contingency table showing the frequency of each nitrate level within each shipping category.
We then conducted a chi-square test on the resulting 3×3 contingency table. This test allowed us to assess whether nitrate concentrations were independent of shipping density across the Atlantic sample. The chi-square statistic, p-value, and expected counts were recorded and used to evaluate whether observed patterns were likely due to chance. A significant result here served as preliminary evidence that shipping activity and nitrate levels are related, providing justification for a more detailed investigation using linear modeling.

## ANOVA
To further explore how nitrate levels vary across different environmental zones, we conducted a one-way analysis of variance (ANOVA) using the cluster assignments generated from the K-means analysis. The goal was to determine whether the mean nitrate concentrations differed significantly between the four clusters identified in the Atlantic Ocean region.
We first filtered the dataset to the Atlantic bounding box to maintain consistency with previous analyses. Observations with missing nitrate values or undefined cluster assignments were excluded. The remaining data were then grouped by cluster, and nitrate values were extracted for each group.
Using the scipy.stats.f_oneway() function, we performed an ANOVA test comparing nitrate concentrations across the four clusters. This test allowed us to assess whether the differences in mean nitrate levels between the clusters were greater than would be expected by chance alone. The resulting F-statistic and p-value were used to evaluate statistical significance.
This approach complements the chi-square analysis by treating nitrate as a continuous variable rather than a categorical one, enabling a more granular assessment of nitrate distribution patterns across distinct environmental zones.

## Linear Regression
Following the chi-square and ANOVA analyses, we applied a linear regression model to assess the strength and nature of the relationship between shipping density and nitrate levels. While the chi-square test established a categorical association and the ANOVA revealed differences across clusters, regression allowed us to quantify the relationship between these two continuous variables.
We focused this analysis on observations from the Atlantic Ocean, where data coverage was densest. To reduce skewness and address heteroscedasticity in the raw data, we applied a log transformation to both the nitrate concentration and shipping density variables. A small constant (+1) was added to each value prior to transformation to avoid taking the logarithm of zero.
An ordinary least squares (OLS) regression was performed using log-transformed shipping density as the independent variable and log-transformed nitrate concentration as the dependent variable. We used the statsmodels package to fit the model and generate diagnostic statistics including the regression coefficient, R-squared value, and p-value. A scatterplot with the regression line was created to visually confirm the linear relationship and assess model fit.
This regression helped verify that shipping density is a significant predictor of nitrate levels even after accounting for spatial variation, and provided insight into the direction and magnitude of that effect.
